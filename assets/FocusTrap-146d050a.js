import{r as a}from"./index-61bf1805.js";import{u as m}from"./use-did-update-ace30b87.js";import{r as p}from"./use-id-ffac3e23.js";import{u as A}from"./use-merged-ref-f796d887.js";import{i as T}from"./OptionalPortal-7fa477af.js";function k({opened:t,shouldReturnFocus:n=!0}){const e=a.useRef(),o=()=>{var r;e.current&&"focus"in e.current&&typeof e.current.focus=="function"&&((r=e.current)==null||r.focus({preventScroll:!0}))};return m(()=>{let r=-1;const u=i=>{i.key==="Tab"&&window.clearTimeout(r)};return document.addEventListener("keydown",u),t?e.current=document.activeElement:n&&(r=window.setTimeout(o,10)),()=>{window.clearTimeout(r),document.removeEventListener("keydown",u)}},[t,n]),o}const v=/input|select|textarea|button|object/,f="a, input, select, textarea, button, object, [tabindex]";function y(t){return t.style.display==="none"}function E(t){if(t.getAttribute("aria-hidden")||t.getAttribute("hidden")||t.getAttribute("type")==="hidden")return!1;let e=t;for(;e&&!(e===document.body||e.nodeType===11);){if(y(e))return!1;e=e.parentNode}return!0}function d(t){let n=t.getAttribute("tabindex");return n===null&&(n=void 0),parseInt(n,10)}function c(t){const n=t.nodeName.toLowerCase(),e=!Number.isNaN(d(t));return(v.test(n)&&!t.disabled||t instanceof HTMLAnchorElement&&t.href||e)&&E(t)}function l(t){const n=d(t);return(Number.isNaN(n)||n>=0)&&c(t)}function N(t){return Array.from(t.querySelectorAll(f)).filter(l)}function g(t,n){const e=N(t);if(!e.length){n.preventDefault();return}const o=e[n.shiftKey?0:e.length-1],r=t.getRootNode();if(!(o===r.activeElement||t===r.activeElement))return;n.preventDefault();const i=e[n.shiftKey?e.length-1:0];i&&i.focus()}function h(t,n="body > :not(script)"){const e=p(),o=Array.from(document.querySelectorAll(n)).map(r=>{var u;if((u=r==null?void 0:r.shadowRoot)!=null&&u.contains(t)||r.contains(t))return;const i=r.getAttribute("aria-hidden"),s=r.getAttribute("data-hidden"),b=r.getAttribute("data-focus-id");return r.setAttribute("data-focus-id",e),i===null||i==="false"?r.setAttribute("aria-hidden","true"):!s&&!b&&r.setAttribute("data-hidden",i),{node:r,ariaHidden:s||null}});return()=>{o.forEach(r=>{!r||e!==r.node.getAttribute("data-focus-id")||(r.ariaHidden===null?r.node.removeAttribute("aria-hidden"):r.node.setAttribute("aria-hidden",r.ariaHidden),r.node.removeAttribute("data-focus-id"),r.node.removeAttribute("data-hidden"))})}}function w(t=!0){const n=a.useRef(),e=a.useRef(null),o=u=>{let i=u.querySelector("[data-autofocus]");if(!i){const s=Array.from(u.querySelectorAll(f));i=s.find(l)||s.find(c)||null,!i&&c(u)&&(i=u)}i&&i.focus({preventScroll:!0})},r=a.useCallback(u=>{if(t){if(u===null){e.current&&(e.current(),e.current=null);return}e.current=h(u),n.current!==u&&(u?(setTimeout(()=>{u.getRootNode()&&o(u)}),n.current=u):n.current=null)}},[t]);return a.useEffect(()=>{if(!t)return;n.current&&setTimeout(()=>o(n.current));const u=i=>{i.key==="Tab"&&n.current&&g(n.current,i)};return document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u),e.current&&e.current()}},[t]),r}function x({children:t,active:n=!0,refProp:e="ref"}){const o=w(n),r=A(o,t==null?void 0:t.ref);return T(t)?a.cloneElement(t,{[e]:r}):t}x.displayName="@mantine/core/FocusTrap";export{x as F,k as u};
//# sourceMappingURL=FocusTrap-146d050a.js.map
